<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bill Denney" />


<title>Superposition of Pharmacokinetic Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Superposition of Pharmacokinetic Data</h1>
<h4 class="author">Bill Denney</h4>


<div id="TOC">
<ul>
<li><a href="#load-the-data" id="toc-load-the-data">Load the
data</a></li>
<li><a href="#compute-the-superposition-from-single-dose-data-to-steady-state" id="toc-compute-the-superposition-from-single-dose-data-to-steady-state">Compute
the Superposition from Single-Dose Data to Steady-State</a></li>
<li><a href="#nonstandard-superposition-computations" id="toc-nonstandard-superposition-computations">Nonstandard
Superposition Computations</a>
<ul>
<li><a href="#compute-the-superposition-from-single-dose-data-to-a-specific-dose" id="toc-compute-the-superposition-from-single-dose-data-to-a-specific-dose">Compute
the Superposition from Single-Dose Data to a Specific Dose</a></li>
<li><a href="#compute-the-superposition-from-single-dose-data-with-1-dose-per-interval" id="toc-compute-the-superposition-from-single-dose-data-with-1-dose-per-interval">Compute
the Superposition from Single-Dose Data with &gt;1 Dose Per Interval</a>
<ul>
<li><a href="#show-the-curve-to-steady-state" id="toc-show-the-curve-to-steady-state">Show the Curve to
Steady-State</a></li>
</ul></li>
</ul></li>
<li><a href="#time-point-selection-and-addition" id="toc-time-point-selection-and-addition">Time Point Selection and
Addition</a></li>
<li><a href="#interpolation-and-extrapolation-methods" id="toc-interpolation-and-extrapolation-methods">Interpolation and
Extrapolation Methods</a></li>
</ul>
</div>

<p>Examples simplify understanding. Below is an example of how to use
the theophylline dataset to estimate the concentration for each subject
after multiple doses.</p>
<div id="load-the-data" class="section level1">
<h1>Load the data</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## It is always a good idea to look at the data</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(datasets<span class="sc">::</span>Theoph))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">Wt</th>
<th align="right">Dose</th>
<th align="right">Time</th>
<th align="right">conc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.00</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.25</td>
<td align="right">2.84</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.57</td>
<td align="right">6.57</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">1.12</td>
<td align="right">10.50</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">2.02</td>
<td align="right">9.66</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">3.82</td>
<td align="right">8.58</td>
</tr>
</tbody>
</table>
<p>The columns that we will be interested in for our analysis are conc,
Time, and Subject in the concentration data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## By default it is groupedData; convert it to a data frame for use</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>conc_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAconc</span>(<span class="fu">as.data.frame</span>(datasets<span class="sc">::</span>Theoph), conc<span class="sc">~</span>Time<span class="sc">|</span>Subject)</span></code></pre></div>
</div>
<div id="compute-the-superposition-from-single-dose-data-to-steady-state" class="section level1">
<h1>Compute the Superposition from Single-Dose Data to Steady-State</h1>
<p>With a simple call, we can have the estimated steady-state
concentration for each subject. At minimum, the time between dosing
(<code>tau</code>) must be provided.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>steady_state <span class="ot">&lt;-</span> <span class="fu">superposition</span>(conc_obj, <span class="at">tau=</span><span class="dv">24</span>)</span></code></pre></div>
<pre><code>## Error in superposition.numeric(conc = nested_data$data_conc[[idx]]$conc, : The first concentration must be 0 (and not NA).  To change this set check.blq=FALSE.</code></pre>
<p>The error noting that the first concentration must be zero is due to
the fact that superposition usually occurs with single-dose data. If the
first concentration is nonzero, the data are not likely to be
single-dose (or a data error should be fixed). Let’s find the offending
data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">subset</span>(datasets<span class="sc">::</span>Theoph, Time <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> conc <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Nonzero predose measurements&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>             <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Nonzero predose measurements</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">Wt</th>
<th align="right">Dose</th>
<th align="right">Time</th>
<th align="right">conc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">64.6</td>
<td align="right">4.95</td>
<td align="right">0</td>
<td align="right">0.15</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">58.2</td>
<td align="right">5.50</td>
<td align="right">0</td>
<td align="right">0.24</td>
</tr>
</tbody>
</table>
<p>For this example, we will assume that these were errors, correct them
to zero, and recalculate.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">## Correct nonzero concentrations at time 0 to be BLQ.</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>theoph_corrected <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(datasets<span class="sc">::</span>Theoph)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>theoph_corrected<span class="sc">$</span>conc[theoph_corrected<span class="sc">$</span>Time <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>conc_obj_corrected <span class="ot">&lt;-</span> <span class="fu">PKNCAconc</span>(theoph_corrected, conc<span class="sc">~</span>Time<span class="sc">|</span>Subject)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">## Calculate the new steady-state concentrations with 24 hour dosing</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>steady_state <span class="ot">&lt;-</span> <span class="fu">superposition</span>(conc_obj_corrected, <span class="at">tau=</span><span class="dv">24</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(steady_state, <span class="at">n=</span><span class="dv">14</span>),</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Superposition at steady-state&quot;</span>)</span></code></pre></div>
<table>
<caption>Superposition at steady-state</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">4.856234</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">7.637741</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">9.008665</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">11.293912</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.099676</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.063389</td>
<td align="right">2.02</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">12.615588</td>
<td align="right">3.82</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">12.152885</td>
<td align="right">5.10</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">10.924249</td>
<td align="right">7.03</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">10.022157</td>
<td align="right">9.05</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">8.639209</td>
<td align="right">12.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">4.857207</td>
<td align="right">24.00</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">1.010060</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2.703513</td>
<td align="right">0.27</td>
</tr>
</tbody>
</table>
<p>The output is a tbl_df, tbl, data.frame including all the grouping
factors as columns, a column for <code>conc</code>entration, and a
column for <code>time</code>. Time point selection ensures that the
beginning and end of the interval are included and that every measured
time that contributes to the interval is included. The points at the
beginning and end of the interval are very similar; they are within a
tolerance of 0.001 as defined by the <code>steady.state.tol</code>
argument to superposition.</p>
</div>
<div id="nonstandard-superposition-computations" class="section level1">
<h1>Nonstandard Superposition Computations</h1>
<div id="compute-the-superposition-from-single-dose-data-to-a-specific-dose" class="section level2">
<h2>Compute the Superposition from Single-Dose Data to a Specific
Dose</h2>
<p>If simulation to a specific dose is needed, the number of dosing
intervals (<code>n.tau</code>) can be specified.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## Calculate the unsteady-state concentrations with 24 hour dosing</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>unsteady_state <span class="ot">&lt;-</span> <span class="fu">superposition</span>(conc_obj_corrected, <span class="at">tau=</span><span class="dv">24</span>, <span class="at">n.tau=</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(unsteady_state, <span class="at">n=</span><span class="dv">14</span>),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Superposition before steady-state&quot;</span>)</span></code></pre></div>
<table>
<caption>Superposition before steady-state</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">3.3393647</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">6.1391369</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">7.5187500</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">9.8183657</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">13.6629359</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">12.6879608</td>
<td align="right">2.02</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">11.3550445</td>
<td align="right">3.82</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">10.9681517</td>
<td align="right">5.10</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">9.8452907</td>
<td align="right">7.03</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">9.0438064</td>
<td align="right">9.05</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">7.7960929</td>
<td align="right">12.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">4.3830987</td>
<td align="right">24.00</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">0.9268958</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2.6226541</td>
<td align="right">0.27</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-the-superposition-from-single-dose-data-with-1-dose-per-interval" class="section level2">
<h2>Compute the Superposition from Single-Dose Data with &gt;1 Dose Per
Interval</h2>
<p>Some dosing intervals are more complex than once per X hours (or days
or weeks or…). To predict more complex dosing with superposition, give
the dose times within the interval. The <code>dose.times</code> must all
be less than <code>tau</code> (otherwise they are not in the
interval).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="do">## Calculate the new steady-state concentrations with 24 hour dosing</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>complex_interval_steady_state <span class="ot">&lt;-</span> <span class="fu">superposition</span>(conc_obj_corrected, <span class="at">tau=</span><span class="dv">24</span>, <span class="at">dose.times=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(complex_interval_steady_state, <span class="at">n=</span><span class="dv">10</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>             <span class="at">caption=</span><span class="st">&quot;Superposition at steady-state with complex dosing&quot;</span>)</span></code></pre></div>
<table>
<caption>Superposition at steady-state with complex dosing</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">16.10210</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">18.74815</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">20.05464</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">22.23332</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">25.75130</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">24.29240</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">24.48753</td>
<td align="right">2.02</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">26.79323</td>
<td align="right">2.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">28.03334</td>
<td align="right">2.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">30.10259</td>
<td align="right">2.57</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(complex_interval_steady_state,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y=</span>conc, <span class="at">x=</span>time, <span class="at">colour=</span>Subject)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA8FBMVEUAAAAAADoAAGYAOpAAZrYAtPAAujgAv8QAwIszMzM6AAA6ADo6AGY6OmY6OpA6kLY6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmOpBmtv9uTU1uTW5uTY5ubo5ubqtuq+R8rgCOTU2OTW6OTY6Obk2OyP+QOgCQOjqQOmaQZgCQtpCQ29uQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC22/+2//+3nwDHfP/Ijk3I///bkDrb///ejADkq27k///r6+v1ZOP4dm3/ZLD/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///81pRl9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU3klEQVR4nO3dCX/bthUAcKcNJTbdurgHs27NjqjbnG5d2m3JIjWuUkhyPDsOvv+3GR4u4uHkIVKwRPx6mAFpkf88gsSpM3rkifhT4+PPBjy3LNIElEgTUCJNQIk0ASXSBJRICaC752cPXsSObwmkfr31abHNNvv2OrQT0Ktv6NXHP09ATpK5t1+/TlzxCQBt3aT3vv7sH9Mt5k0K6NE3DGm6xdykgBjO7W9fTEBOkrm3v5+A/Ellv5puMX9S2bdPzj6KPshOHSiZJqA+QB9+uKD0/bfnX/4yAXnT2/MLjvT2q1ZAmx5X2ePQ8YFu/vS3C/r+r2/ozR/fTEBu+vDjf1j03Pz5F/r+Ly/Z9icsNfqdm03jjx8+DQj09hncXu++VEDGx0X/Ljd0E848oghiofMBRVBzIHSTHS3Q23NIz9qXQacCRMVj/sMPz1o+xU4MqP17EAMyhY4ZKPhxE1APoA3f3PgzJ6AJKHmqAqgWyhro8gzSNxOQk4w9xu72kUBaKHegeIvrgEBK6OBAazeZe18+jF7x3oE2JDcgb9L5iQAaEkgKZQ4UL4EmIPrqcfyKhwQSQnkD3X334oBAXChvoFQRdPJAyTQskLXV9qInoAmofm3sctHHCGSXOhOQtTkBJU7VeW5tJqAJqBeQ1RE9ATm5E1ACCHdEHztQMnnGLRx2KMPIQMm/S08E4ZvsyCMoeao+oM490UcI5GkByhvo+tG4o1z9QF17oocHguagyzG7fQJAHTtahwfiUxGiM35OAGjppvwiqFtH6whl0O2Ts3i3xlhAnTpaR7jFPn1Br6Kl9GhAXfoRhweCXrGRZvtsaoV7BDRiBCWByKZ1N9kIZdDV2dlIUzLF5ceA2vcCHdOb9IZfve5sXq1813HaQPIfvrkCIolkWLXtBTpqIGHDEp2AVH10I4F2K5yJhCagKFC7NvwjApIPeQlkX4cZQhMQA9rhTBxCLS766IBIAAiXQs0v+viAeNrRGFCbTo7jAUIXvaOoFOL7mu+NzdvwJ6CTBTKFxL4rY7NxG/5xAq2SQI3b8DMHend+/sWbZjMO00BaKDug61+9Nv7XAghm8r79qtHKC+gO40CGkAeoaRv+GEBXol/sKtQ9Fr/FGFKTWc9NgJRQZkCvHnwPoSP/1xqIhU6TlRfQ8AQGxNLO2WkVPGLQRMjCTXu5xVj8PP38ZaOVF1ARRAIRJEOI4kMOHUG9gCjINFl5AZfRIlcL+YEateHnD0R/umhbBoWBhBDFB91jIHlvNVl5wQWqKg8QF2pz0XkDweIdrAxq8h5kA1UVI9q5+2KgdC9Q5kCRj8MfixrBGFDFf/AAgZCxmezkyPxNuieQEkL7rtBmqg3/5IFSbfjHCMRegxSQFML7riK2zs5HClSpzQnIc5UmkBCyTnGFN6NN1EcJxO4wvckf9XGgaBP10QMRDxDFQtEW2OMHghCagCJAxANErI7pSBP1kQCZLzNQRpu51S4NFG6BPQEg4gFCQlT8Bv9FnwKQaD7Dl+UAhUZRnyoQ6omOXfRJAFmDYQJA/hbYEYCuzoaf7ZMCqtAmFbvZV+ltgR0eCFqB4mt0DQE0x6fijKfyAXlbYMe5xUJNZUMBETJHQhSHEJX7Ob8pPsS6B9DMTWjvMSOIB5ANRJzhQl4g/2zOPQB5k86/fjTgSHs1/cAGQjcZxaUQVXu6V+k0MI5ziw04mWWzsS5LAZlClLjDhbICgq+vGR5oFwWq0KYpFCzNxgEadjqUHl2PgeaQWwvBljsaxu5olUKjR9Dlnmf7oLRR/7C021E+72BX0Tlsz9Ge7lAGazCD8Sv3nBJAydQzgsToesqH/vKQgKc8z9UhROUfO3/vuCea6F/ZOGQaXfKhgXg5xIHELQNAMxfI1xPtA+rzlRwjAN09f8z+jb03hYFkkGggLUTVnzuX5e2q77pKwyhArx5ypYiQeW716Hp4F1xJoHI2p0hIHOPrqrd6omVux1UaxgC6fcJfCGKTXD1ARAKJINmVZU+gjosQ3BuggsxLYgrJY6oGPdG5A9FLoLl9EllAOAi0IgpoTkpiCsWA7I5W6xdnBwTNR2dnsQWWY0AgVAHQUgmZQEqoAVCnVRrye8yjwlQB7YqyqIG4kAZq0hOt6jDHB0RMICSkT7HydbT6gZoMYDwE0PUj/j0czQppFwhehoo5A4IYagjkdLSaQrkBxd8RGwMtWa4hVJ9i5etoDQC1XoRgxMd8D6BdxcroAnKVUBLI7WithXIDunveAghVCdRbYA3EhGQIGadYNeto1UK5ASUWimkCRDQQUSGEgJp1tCqhNhOAOwJBsRsNC3yLnTUvpL1A1UwBrdfrEldahVCrjtZ2q5x2AYLWRFhDqBlQgxQHqggALQsC356jQwgBNeto1VttWj+6AF3BY2mYNmkPELt8AbQWfyyEqBVCnqv0rqXj+ZhuQKWb0N5t2qQvm1c1XCBomZ/BW5AGWnuAfB2t3m4y4nlYdgLypnoHaARrCtSmsmrNzxA+HGhRqD/nQhTfZI37EdVW48p9N6Do5dIezR02kOjZmRWLBdFC/B6jqBjyA3m7yeyq60BPscSrzf6BlmRdhxATgmNMocb9iHbVdQigpE/nW8yax6umHwDQmhohRGYukK+bzNePaFVdhwBq+yWQzQtpvNaCCiB4TzSBIIR4iW30I1btgZpV7rsApVPXx3wUiKAQwkIUh5C+AF9HK666Zgd08/T8PPhdz0EgVgQxIFILUbsXqGrcj4irrhkAoX4xmOp884eXgZUXLCA1OoEBreHMjRCi+IWa4lKoKVCDyv0IQKhf7B2oBGc9Ww8xB0iF0LKk+CajuJw2LsDtR8RV18MDuY95NG8erbxgjjJY7WglBysUJSuCWFrQQmaW7N8Z/0mPZ6jgP57xDN7hDHXqNrBhUCCYEh5YecGOIDnsrigJjyBUCskQqjs5jBBCF2B3k1lXt4lX7ocHst+D3n/7jNLAygsOEL/8pQGkhMql003Gb0hPL1ACKFG5HwEI94vdPL0ApWZlkBhVxoDW8sx1CFEmZIQQz6xDCF/AKgEUrdyPAWQm4UMDKy94gGDwpgDaEiOEKA8hLaSBGnSTeUrlSOV+bKC355AuGrwHrXaVKIHmCsgUosZNptvwq6ojUKRyPzZQ7ONcIFnKcKAtkUBciPJiSIeQ+hVVgwmb3ud6sHKfLRCM3JyLEJkVhAMRI4QAiNRCCaBwE36ycp8v0K6AWwwG+M94Y+KWmEJwTB1CdaWsSk/YDLwZBir3uQNBOVMDwX/ETcaPqYV0C6x4krkGDSaT+Sv3HYESvYF7ASqreVkDbcVeWxlCYqtczsgaAYkQ8hiEmvBTlfuOQJfN+8V6ABVL/qgygZSQBCLL2UwcikLIZxBooU5V7rsBXf/6d0MA4YcYAPG7aAalsgGEX6j5TUaJKdQVyFe5D53x3E313nff/XOQW8x6yhMGxAiWpQkkQ4hiIcicayBvN1mghTpVuY+esZ1U9uXjYcog+zWII5QEgLbEAGJCVMYQf9YjoEBHKwk0wFqbzsIxXYCuP/t5QKB6AstcGvAiqL4QLkTVXSZeqHlmLeTtR/Q3wDqV+z0AiUb7WCv8XoG4hAeoFpJAtVAAyD9PwdrEzR+dgOhQj3kBtNNAy8IHpKscRN6CS9ELZAp5+xFJwyUFUeX+ngBtiQ9ICtW11rqgDgAFhuFbm2blviNQIvW7xXYSiASA+BYWWmMhWvk6WqVQGsis3OcEJE5LA80XC+jGWK8dIH7DISGKhSiOIXQ9/lHm1mZduc8OaEc00BKuf+2JIP5WZAIRK4aoOZfMNggMosabunKfIxBMYpFAvCes4KWODYSE6FIDqQZGQwhfT3CMMNpUlfucgKgGgkksFQCRAJD1JEPFkGw/q3z9iGIr3X6WuuTDAq1g4IsAWkMI+YDollg32ZrUQnzfytePSOzGj3sIJOZASSC4ybxABAlRSygB1HitoRyB1AwfAFrzjp5i671KU4jiGBIPey3kAjVpHsoZiL0tFhIIhJoBkfqFkWIhD1Cj1o+sgao5VUALP5ApRGUxJIWousl8vUC4bn8vgMwkhx/AHUbXdMt+XCy2gX23MJ4BEh/TAM96NaRBDmqo/MsziJQY1RBNh4wg8bMsgkRnYSCCIIZECNmPMtU85O0FwnX7exFBxrnpr3o0gLaeM5dbSog3MPIXajEOnxDzJgsANWr9yBtoq/sLg0BCSDQw6mKI59ZCIaAmrR+dgK4fDbYKngFEORALogiQEqLGTYbazzydHLhuPwQQDIm6/PjnYYDUZzGgtYydGJBqwycyhISQzNVCYYJk60cXoOvPhltgSc8RK2og35nXW1sJROpiqB71QTxt+FbdviNQ4abxgbboVEPXseWdHEiIYiH3CzZNoW5A3iRz+S32IBsgEBKbhbjJYEy1IQSLeIbaF2Ez3vrRBQgK6d98NwiQXA6HXVRRNgbSD3tVDFl3GazVHWw+S7V+dAJi6fbrQVbiNIFwERQDIluKhaglRPzD8PWn7hkIyp+BVuJkQPKKGNAWf3hkq46hAoDsGKKBeQp6M9L60QUIhq1Gn/L9gOZz+BtvB0RJXemAuaNYiAbmKdSb4daPTkDJ1BVoxafIQwDNWwLpWhkXoiKGZJrjmRze53qw9SNHoAqiqG0EGUIApKtlcufQMPxk60eGQHy4M4uDrfXhcSBTSKzzUQvpgto3RlhtBsZ+5AckxoM7AZQEMoT404y3aMv2s7maeuYdAouE8geqlstuQIYQxUK8gVELBesW3taPDIFmZLlcdgGqhWiJhCgxhLzj82qhrIFWBXvKV/yaWEnbHqhuP+Oj0iAS18b4M/wdd77f5Gn9yBCoLGczWIiiA5A6hhIkxHO1UGh0lRDKHaisCr5wSEcgsl2oTUNI5M7FbBeouobrrk7rR25ApBIzd4v1NlxWRICEEAciBQdynvZmo4H7m+zWj9yAZpUc0dEVSDUwmkIqdz4XjR8kVjWzWj9yBCJiwEJXINV+ZgiZnfbyi8p2wZoHbv3IEIgL9QFS7WdaiKJhDfj7SFOtH3kB7Upe0YABC32A1OtQSYQQJaYQjX1jq9P60RGIf3NNeK23KBCfzOubkrkiGmjdD4iKzlglBLm10BzHkO83Ga0f3YCuoF8sstZbDOjd+RdvqHdpCgCqeKHBByz0ASKGEF/E0xBiNbNKvTOGah5160cnoFcPvmcRFFnrLQL00+f/ZhHknRbOX4PghzVZ9AUyhEjBa3dG4wcqiPy/Sbd+hIAqNzm3GA2u9Za8xfxLUwAQ/H8dGdHROMnfAItYFHQJP87WKm8+FytZ0PDoj/jYj0QEaaDQWm9JIP/SFCKCtmJUUM8Ighjayhii8nE/00M/iFEQxboV+xXS4XW3WkSQCwRjOrb2wOgOQPw+JWItHSmk55YZQv714fYCFF7LLAnkX5qCA63V7N3eQKogKimphdTIBi1EvevD7QMostZbEsi/NIUAamTQDEgJEf4wE3+kZpIT0XsiqmbhmkcPoMhab93egxhQNd8vkCiIKAhpIi1E5lWl9g12CnUESqSOb9IAVDck7gWIlfbwwsCFJBGd1UFE9LdvhqpmuQGRfQNBUU2JFOJE1LzN6i/ZDlTNjh9I3mZSSEaRDiJZEHEhb83jFID4baaFFJEOovqbAH2dQrkBGX0Z+wOiSIiKusdML/uBhE4TCGJoS8pSZRaCSCz7gWLI6RTKCoi9Bg0ExIpqHkSlyuREs7V8sa7wbXaKQEQEERDJTCCC20xUzbSQ3Sl0OkA8iFQU1URruYZVpffFnUJ5AbHTHA5IEVEtBEQzSTSv6n3NTqG8gMwAGgBIEZUGEVFrNNV1V9QplBPQrhgcCIgoIioKooKoqvetO4VODsiJIgpESy1k1zxyAqLjAFFMxF+LZoKoqpxDOwLxBrPbJ6HBrt2AitlIQDqKdCYjEi371X6AeLcPrAATGC7dEQg9xAYFkkT862bkh8OXBJK6u6MXkOj2gcH2qndjX0Dh6T37BtJEOlMQ0WqOdg6d8cpN9i0WmfRzL4CMKFInQNaMCAnFz9hOGOjq430DVeW4QLKKhp75jMgU6gO0/wgaH4g3OGKi9doU6gO0/zLoEECECiK1OWNE7HGvv4+iBxB0q+71KVYtSvRpba6yxaabCUQqiKgkUt9H0QNo7+9BBwMyiSiMcigK3e/aESiRui1NUSzKTsftJQki8fNsxuof0b1HBpK/fobnr4wZQZAkkTiVxCW7NrG99wfU/yp7HcqJ5LmohXZyAqKHBuJEJS4IcwJaHB7IIcoKyJpCdxggionyAtrjVfY61CDKCmhhfVq/q+x1qByclhnQvq+y16Fqat4ElNicgCagCWjQQyegYYACDWUTkExXg62CN8xV9ji0E5Do9jltoI2bplvMOWM7TUAHApLpk+65Yx86ASVyJ6BE7gSUyE0CJVKPFcnvR5qAEmkCSqQJKJEmoEQ6ABCaxOok+Bb2L97489w5sE6u//Cbp/DF7qFDZa7/0PGB8GIeTvrpIpjlWQvEzvUfDvP2b/7wMnCozA188vhAeCK9nT78+DKQ410LxM71H/4OVH66CBwqcwOfPD4QXorBTuwu4PHuP9RZycHODR/Ojol8MvvjwKHjA+HFPOwEsR6MInctEDs3eDisbxA+FHIDh+YWQTyFyqF0BIUOf//ts8gn89zAobmVQYHTFMldC8TODRx+8/Qi8skiN3DoIZ5izyJPMbgNPvwr8pgPH65uQPdwKRA4VOYGPnl8oPR70OfBAqrRe5B7OLzhQAHsP1Tl+j85AQTLmkS7NU79Tdq/cJmRThzoLvqlI5BOAGjnJg10+yS0bpBKJwAUiyBYPDEeRScOxFO0HJqAMgP6339Da4IOlOJAMJPu7u8ZPebHxYGUiCD2HvQgekqnDpRM4wLBqsSPGdL1p9/zn8QixXfPzxKDdHqk+wXEIwiAHrF7/xLmsF1+9Pru+UOa+KrKHum+An0jlwdlG1cfvRZfNjhIuqdAUBSp/4hlMM8Ci832TccANNTdtZeUAdBV/Dl74DQyEBQ1NtDdcxZC2SqN/Sb96uyhDcQf87n6HH9drG+agBJpAkqkCSiRJqBEmoASaQJKpAkokSagRJqAEun/QJwSZNgXtM0AAAAASUVORK5CYII=" /><!-- --></p>
<p>With this more complex dosing interval, the number of time points
estimated increases. The next section describes the selection of time
points.</p>
<div id="show-the-curve-to-steady-state" class="section level3">
<h3>Show the Curve to Steady-State</h3>
<p>To determine the concentration curve to get to steady-state, you can
give all the dose times considered required to get to steady-state. To
do this, specify tau as the total time to steady-state, specify
<code>n.tau</code> as <code>1</code> to indicate that only one round of
dosing should be administered.</p>
<p>This command does not technically go to steady-state; if the
<code>dose.times</code> are not sufficiently long to reach steady-state,
it only goes for as many doses as requested.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>up_to_steady_state <span class="ot">&lt;-</span> <span class="fu">superposition</span>(conc_obj_corrected,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                                    <span class="at">tau=</span><span class="dv">4</span><span class="sc">*</span><span class="dv">24</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                                    <span class="at">n.tau=</span><span class="dv">1</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                                    <span class="at">dose.times=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="sc">*</span><span class="dv">24</span>, <span class="at">by=</span><span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(up_to_steady_state, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>conc, <span class="at">colour=</span>Subject)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="time-point-selection-and-addition" class="section level1">
<h1>Time Point Selection and Addition</h1>
<p>Superposition is often used to estimate NCA parameters with
nonparametric methods. To ensure that estimated parameters are as
accurate as possible (especially <span class="math inline">\(C_{max}\)</span>), each dose has every post-dose
time point included. Specifically, each dose will have the following
times:</p>
<ul>
<li>0 (zero) and <code>tau</code>,</li>
<li>The time of each dose (the <code>dose.times</code> argument)</li>
<li>Every value from the time column of the data modulo <code>tau</code>
(shifting the time for each measurement to be within the dosing
interval) repeated for each dose, and</li>
<li>each time from the <code>additional.times</code> argument.</li>
</ul>
<p>How the number of time points increases can be seen by comparing the
time points for subject 1 in the steady-state single dosing and the
complex dosing examples above.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>steady_state<span class="sc">$</span>time[steady_state<span class="sc">$</span>Subject <span class="sc">==</span> <span class="dv">1</span>]</span></code></pre></div>
<pre><code>##  [1]  0.00  0.25  0.37  0.57  1.12  2.02  3.82  5.10  7.03  9.05 12.12 24.00</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">sum</span>(steady_state<span class="sc">$</span>Subject <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>complex_interval_steady_state<span class="sc">$</span>time[complex_interval_steady_state<span class="sc">$</span>Subject <span class="sc">==</span> <span class="dv">1</span>]</span></code></pre></div>
<pre><code>##  [1]  0.00  0.25  0.37  0.57  1.12  2.00  2.02  2.25  2.37  2.57  3.12  3.82
## [13]  4.00  4.02  4.25  4.37  4.57  5.10  5.12  5.82  6.02  7.03  7.10  7.82
## [25]  9.03  9.05  9.10 11.03 11.05 12.12 13.05 14.12 16.12 24.00</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">sum</span>(complex_interval_steady_state<span class="sc">$</span>Subject <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 34</code></pre>
</div>
<div id="interpolation-and-extrapolation-methods" class="section level1">
<h1>Interpolation and Extrapolation Methods</h1>
<p>The interpolation and extrapolation methods align with those used for
calculating the AUC. By default, interpolation uses the
<code>PKNCA.options</code> selection for <code>&quot;auc.method&quot;</code> and
extrapolation follows the curve of <span class="math inline">\(AUC_{inf}\)</span>. These can be modified with the
<code>interp.method</code> and <code>extrap.method</code> arguments.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
