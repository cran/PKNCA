<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Bill Denney" />


<title>Introduction to PKNCA and Usage Instructions</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to PKNCA and Usage
Instructions</h1>
<h4 class="author">Bill Denney</h4>


<div id="TOC">
<ul>
<li><a href="#quick-start" id="toc-quick-start">Quick Start</a></li>
<li><a href="#data-handling" id="toc-data-handling">Data
Handling</a></li>
<li><a href="#options-make-pknca-work-your-way" id="toc-options-make-pknca-work-your-way">Options: Make PKNCA Work Your
Way</a>
<ul>
<li><a href="#calculation-options-the-pknca.options-function" id="toc-calculation-options-the-pknca.options-function">Calculation
Options: the PKNCA.options Function</a></li>
<li><a href="#summarization-options-the-pknca.set.summary-function" id="toc-summarization-options-the-pknca.set.summary-function">Summarization
Options: the PKNCA.set.summary Function</a></li>
</ul></li>
<li><a href="#grouping-nca-data" id="toc-grouping-nca-data">Grouping NCA
Data</a></li>
<li><a href="#selecting-calculation-intervals" id="toc-selecting-calculation-intervals">Selecting Calculation
Intervals</a>
<ul>
<li><a href="#selection-of-data-used-for-calculation" id="toc-selection-of-data-used-for-calculation">Selection of Data Used
for Calculation</a></li>
<li><a href="#automatic-interval-determination" id="toc-automatic-interval-determination">Automatic Interval
Determination</a></li>
<li><a href="#manual-interval-specification" id="toc-manual-interval-specification">Manual Interval
Specification</a></li>
<li><a href="#keeping-a-column-from-intervals" id="toc-keeping-a-column-from-intervals">Keeping a column from
intervals</a></li>
</ul></li>
<li><a href="#summarizing-results" id="toc-summarizing-results">Summarizing results</a></li>
</ul>
</div>

<p>PKNCA provides functions to complete noncompartmental analysis (NCA)
for pharmacokinetic (PK) data. Its intent is to provide a complete
R-based solution-enabling data provenance for NCA. This will include the
tracking of data cleaning, enabling of calculations, exporting of
results, and general reporting. The library is designed to give a
reasonable answer without user intervention (load, calculate, and
summarize), but it allows the user to override the automatic selections
at any point.</p>
<p>The library design is modular to allow expansion based on needs
unforseen by the authors including new NCA parameters, novel data
cleaning methods, and modular summarization decisions. Expanding the
library will be discussed in a separate vignette.</p>
<div id="quick-start" class="section level1">
<h1>Quick Start</h1>
<p>The simplest analysis requires concentration and dosing data at a
minimum. Given this, it then takes five function calls to provide
summarized results. (Please note that this and the other examples in
this document are intended to show the typical workflow, but they are
not intended to run directly. For an example to run directly, please see
<a href="v02-example-theophylline.html">the theophylline
example</a>.)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(PKNCA)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## Load the PK concentration data</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>d_conc <span class="ot">&lt;-</span> datasets<span class="sc">::</span>Theoph</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## Generate the dosing data</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>d_dose <span class="ot">&lt;-</span> d_conc[d_conc<span class="sc">$</span>Time <span class="sc">==</span> <span class="dv">0</span>,]</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## Create a concentration object specifying the concentration, time, and</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## subject columns.  (Note that any number of grouping levels is</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## supported; you are not restricted to just grouping by subject.)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>conc_obj <span class="ot">&lt;-</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">PKNCAconc</span>(</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    d_conc,</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    conc<span class="sc">~</span>Time<span class="sc">|</span>Subject</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  )</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="do">## Create a dosing object specifying the dose, time, and subject</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## columns.  (Note that the grouping factors should be the same as or a</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="do">## subset of the grouping factors for concentration, and the grouping</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="do">## columns must have the same names between concentration and dose</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">## objects.)</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>dose_obj <span class="ot">&lt;-</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  <span class="fu">PKNCAdose</span>(</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    d_dose,</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    Dose<span class="sc">~</span>Time<span class="sc">|</span>Subject</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>  )</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="do">## Combine the concentration and dosing information both to</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="do">## automatically define the intervals for NCA calculation and provide</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="do">## doses for calculations requiring dose.</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>data_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAdata</span>(conc_obj, dose_obj)</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="do">## Calculate the NCA parameters</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>results_obj <span class="ot">&lt;-</span> <span class="fu">pk.nca</span>(data_obj)</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="do">## Summarize the results</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="fu">summary</span>(results_obj)</span></code></pre></div>
<pre><code>##  start end  N     auclast        cmax               tmax   half.life aucinf.obs
##      0  24 12 74.6 [24.3]           .                  .           .          .
##      0 Inf 12           . 8.65 [17.0] 1.14 [0.630, 3.55] 8.18 [2.12] 115 [28.4]
## 
## Caption: auclast, cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation; N: number of subjects</code></pre>
</div>
<div id="data-handling" class="section level1">
<h1>Data Handling</h1>
<p>After loading data, it must be in the right form. The minimum
requirements are that concentration, dose, and time must all be numeric
(and not factors). Grouping variables have no specific requirements;
they can be any mode.</p>
<p>Values below the limit of quantification are coded as zeros
(<code>0</code>), and missing values are coded as <code>NA</code>.</p>
</div>
<div id="options-make-pknca-work-your-way" class="section level1">
<h1>Options: Make PKNCA Work Your Way</h1>
<div id="calculation-options-the-pknca.options-function" class="section level2">
<h2>Calculation Options: the PKNCA.options Function</h2>
<p>Different organizations have different requirements for computation
and summarization of NCA. Options for how to perform calculations and
summaries are handled by the <code>PKNCA.options</code> command.</p>
<p>Default options have been set to commonly-used standard parameters.
The current value for options can be found by running the command with
no arguments:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">PKNCA.options</span>()</span></code></pre></div>
<pre><code>## $adj.r.squared.factor
## [1] 1e-04
## 
## $max.missing
## [1] 0.5
## 
## $auc.method
## [1] &quot;lin up/log down&quot;
## 
## $conc.na
## [1] &quot;drop&quot;
## 
## $conc.blq
## $conc.blq$first
## [1] &quot;keep&quot;
## 
## $conc.blq$middle
## [1] &quot;drop&quot;
## 
## $conc.blq$last
## [1] &quot;keep&quot;
## 
## 
## $debug
## NULL
## 
## $first.tmax
## [1] TRUE
## 
## $allow.tmax.in.half.life
## [1] FALSE
## 
## $keep_interval_cols
## NULL
## 
## $min.hl.points
## [1] 3
## 
## $min.span.ratio
## [1] 2
## 
## $max.aucinf.pext
## [1] 20
## 
## $min.hl.r.squared
## [1] 0.9
## 
## $progress
## [1] TRUE
## 
## $tau.choices
## [1] NA
## 
## $single.dose.aucs
##   start end auclast aucall aumclast aumcall aucint.last aucint.last.dose
## 1     0  24    TRUE  FALSE    FALSE   FALSE       FALSE            FALSE
## 2     0 Inf   FALSE  FALSE    FALSE   FALSE       FALSE            FALSE
##   aucint.all aucint.all.dose    c0  cmax  cmin  tmax tlast tfirst clast.obs
## 1      FALSE           FALSE FALSE FALSE FALSE FALSE FALSE  FALSE     FALSE
## 2      FALSE           FALSE FALSE  TRUE FALSE  TRUE FALSE  FALSE     FALSE
##   cl.last cl.all     f mrt.last mrt.iv.last vss.last vss.iv.last   cav
## 1   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE
## 2   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE
##   cav.int.last cav.int.all ctrough cstart   ptr  tlag deg.fluc swing  ceoi
## 1        FALSE       FALSE   FALSE  FALSE FALSE FALSE    FALSE FALSE FALSE
## 2        FALSE       FALSE   FALSE  FALSE FALSE FALSE    FALSE FALSE FALSE
##   aucabove.predose.all aucabove.trough.all count_conc count_conc_measured
## 1                FALSE               FALSE      FALSE               FALSE
## 2                FALSE               FALSE      FALSE               FALSE
##   totdose    ae clr.last clr.obs clr.pred    fe sparse_auclast sparse_auc_se
## 1   FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE         FALSE
## 2   FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE         FALSE
##   sparse_auc_df time_above aucivlast aucivall aucivint.last aucivint.all
## 1         FALSE      FALSE     FALSE    FALSE         FALSE        FALSE
## 2         FALSE      FALSE     FALSE    FALSE         FALSE        FALSE
##   aucivpbextlast aucivpbextall aucivpbextint.last aucivpbextint.all half.life
## 1          FALSE         FALSE              FALSE             FALSE     FALSE
## 2          FALSE         FALSE              FALSE             FALSE      TRUE
##   r.squared adj.r.squared lambda.z lambda.z.time.first lambda.z.time.last
## 1     FALSE         FALSE    FALSE               FALSE              FALSE
## 2     FALSE         FALSE    FALSE               FALSE              FALSE
##   lambda.z.n.points clast.pred span.ratio thalf.eff.last thalf.eff.iv.last
## 1             FALSE      FALSE      FALSE          FALSE             FALSE
## 2             FALSE      FALSE      FALSE          FALSE             FALSE
##   kel.last kel.iv.last aucinf.obs aucinf.pred aumcinf.obs aumcinf.pred
## 1    FALSE       FALSE      FALSE       FALSE       FALSE        FALSE
## 2    FALSE       FALSE       TRUE       FALSE       FALSE        FALSE
##   aucint.inf.obs aucint.inf.obs.dose aucint.inf.pred aucint.inf.pred.dose
## 1          FALSE               FALSE           FALSE                FALSE
## 2          FALSE               FALSE           FALSE                FALSE
##   aucivinf.obs aucivinf.pred aucivpbextinf.obs aucivpbextinf.pred aucpext.obs
## 1        FALSE         FALSE             FALSE              FALSE       FALSE
## 2        FALSE         FALSE             FALSE              FALSE       FALSE
##   aucpext.pred cl.obs cl.pred mrt.obs mrt.pred mrt.iv.obs mrt.iv.pred
## 1        FALSE  FALSE   FALSE   FALSE    FALSE      FALSE       FALSE
## 2        FALSE  FALSE   FALSE   FALSE    FALSE      FALSE       FALSE
##   mrt.md.obs mrt.md.pred vz.obs vz.pred vss.obs vss.pred vss.iv.obs vss.iv.pred
## 1      FALSE       FALSE  FALSE   FALSE   FALSE    FALSE      FALSE       FALSE
## 2      FALSE       FALSE  FALSE   FALSE   FALSE    FALSE      FALSE       FALSE
##   vss.md.obs vss.md.pred cav.int.inf.obs cav.int.inf.pred thalf.eff.obs
## 1      FALSE       FALSE           FALSE            FALSE         FALSE
## 2      FALSE       FALSE           FALSE            FALSE         FALSE
##   thalf.eff.pred thalf.eff.iv.obs thalf.eff.iv.pred kel.obs kel.pred kel.iv.obs
## 1          FALSE            FALSE             FALSE   FALSE    FALSE      FALSE
## 2          FALSE            FALSE             FALSE   FALSE    FALSE      FALSE
##   kel.iv.pred auclast.dn aucall.dn aucinf.obs.dn aucinf.pred.dn aumclast.dn
## 1       FALSE      FALSE     FALSE         FALSE          FALSE       FALSE
## 2       FALSE      FALSE     FALSE         FALSE          FALSE       FALSE
##   aumcall.dn aumcinf.obs.dn aumcinf.pred.dn cmax.dn cmin.dn clast.obs.dn
## 1      FALSE          FALSE           FALSE   FALSE   FALSE        FALSE
## 2      FALSE          FALSE           FALSE   FALSE   FALSE        FALSE
##   clast.pred.dn cav.dn ctrough.dn
## 1         FALSE  FALSE      FALSE
## 2         FALSE  FALSE      FALSE
## 
## $allow_partial_missing_units
## [1] FALSE</code></pre>
<p>And, to reset the current values to the library defaults, run the
function with the default argument set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">PKNCA.options</span>(<span class="at">default=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Each of the options is documented where it is used; for example, the
first.tmax option is documented in the <code>pk.calc.tmax</code>
function.</p>
</div>
<div id="summarization-options-the-pknca.set.summary-function" class="section level2">
<h2>Summarization Options: the PKNCA.set.summary Function</h2>
<p>On top of methods of calculation, summarization method preferences
differ. Typical summarization preferences include selection of the
measurement of central tendency and dispersion, handling of missing
values, handling of values below the limit of quantification, and more.
Beyond the method for summarization, presentation is managed through
user preferences. Presentation is typically controlled by rounding to
either a defined number of decimal places or significant figures.</p>
<p>An example is that C<sub>max</sub> may be summarized by the geometric
mean with the geometric CV using three significant figures, and having a
summary result requires that at least half of the available values are
present (not missing). The code below will set this example.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">PKNCA.set.summary</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;cmax&quot;</span>,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;geometric mean and geometric coefficient of variation&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">point =</span> business.geomean,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">spread =</span> business.geocv,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">rounding =</span> <span class="fu">list</span>(<span class="at">signif=</span><span class="dv">3</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Another example is that T<sub>max</sub> is usually summarized by the
median and range, and as measurements are often taken with minute
resolution and recorded in hours, reporting is usually to the second
decimal place.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">PKNCA.set.summary</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&quot;tmax&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;median and range&quot;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">point =</span> business.median,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">spread =</span> business.range,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="at">rounding =</span> <span class="fu">list</span>(<span class="at">round=</span><span class="dv">2</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>)</span></code></pre></div>
<p>If the functions or default rounding options provided in the library
do not meet the summarization needs, a user-supplied function can be
used for rounding.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>median_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>quantprob_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">PKNCA.set.summary</span>(</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="at">name=</span><span class="st">&quot;auclast&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;median and 5th to 95th percentile&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="at">point=</span>median_na,</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="at">spread=</span>quantprob_na,</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="at">rounding=</span><span class="fu">list</span>(<span class="at">signif=</span><span class="dv">3</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>)</span></code></pre></div>
<p>In some cases multiple parameters may need the same summary functions
(as often occurs with simulated data). Many parameters can be set
simultaneously by specifying a vector of <code>name</code>s.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>median_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">median</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>}</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>quantprob_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">quantile</span>(x, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>), <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>}</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">PKNCA.set.summary</span>(</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="st">&quot;auclast&quot;</span>, <span class="st">&quot;cmax&quot;</span>, <span class="st">&quot;tmax&quot;</span>, <span class="st">&quot;half.life&quot;</span>, <span class="st">&quot;aucinf.pred&quot;</span>),</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">&quot;median and 5th to 95th percentile&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  <span class="at">point=</span>median_na,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="at">spread=</span>quantprob_na,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="at">rounding=</span><span class="fu">list</span>(<span class="at">signif=</span><span class="dv">3</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="grouping-nca-data" class="section level1">
<h1>Grouping NCA Data</h1>
<p>As described in the <a href="#quick-start">quick start</a>,
concentration and dose data are generally grouped to identify how to
separate the data. Typical groups for concentration data include study,
treatment, subject, and analyte. Typical groups for dose data include
study, treatment, and subject. By default, summaries are produced based
on the concentration groups dropping the subject (so that averages are
taken across subjects within the other parameters).</p>
<p>The quick start example can be extended to include multiple analytes
as follows. The only difference is the <code>/analyte</code> formula
element in the concentration data. The reason for the slash instead of
the plus is that the last element before a slash is assumed to be the
subject, and as noted before, the subject is (by default) excluded from
the summary grouping (so that summaries are grouped by study, treatment,
etc., but not by subject).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## Generate a faux multi-study, multi-analyte dataset.</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>d_conc_parent <span class="ot">&lt;-</span> d_conc</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>d_conc_parent<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(d_conc_parent<span class="sc">$</span>Subject))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>d_conc_parent<span class="sc">$</span>Study <span class="ot">&lt;-</span> d_conc_parent<span class="sc">$</span>Subject <span class="sc">&lt;=</span> <span class="dv">6</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>d_conc_parent<span class="sc">$</span>Analyte <span class="ot">&lt;-</span> <span class="st">&quot;Parent&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>d_conc_metabolite <span class="ot">&lt;-</span> d_conc_parent</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>d_conc_metabolite<span class="sc">$</span>conc <span class="ot">&lt;-</span> d_conc_metabolite<span class="sc">$</span>conc<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>d_conc_metabolite<span class="sc">$</span>Analyte <span class="ot">&lt;-</span> <span class="st">&quot;Metabolite&quot;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>d_conc_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d_conc_parent, d_conc_metabolite)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>d_conc_both <span class="ot">&lt;-</span> d_conc_both[<span class="fu">with</span>(d_conc_both, <span class="fu">order</span>(Study, Subject, Time, Analyte)),]</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>d_dose_both <span class="ot">&lt;-</span> d_conc_both[d_conc_both<span class="sc">$</span>Time <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> d_conc_both<span class="sc">$</span>Analyte <span class="sc">%in%</span> <span class="st">&quot;Parent&quot;</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="st">&quot;Study&quot;</span>, <span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Dose&quot;</span>, <span class="st">&quot;Time&quot;</span>)]</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="do">## Create a concentration object specifying the concentration, time,</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="do">## study, and subject columns.  (Note that any number of grouping</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="do">## levels is supporting; you are not restricted to this list.)</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>conc_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAconc</span>(d_conc_both,</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>                      conc<span class="sc">~</span>Time<span class="sc">|</span>Study<span class="sc">+</span>Subject<span class="sc">/</span>Analyte)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="do">## Create a dosing object specifying the dose, time, study, and</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="do">## subject columns.  (Note that the grouping factors should be a</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="do">## subset of the grouping factors for concentration, and the columns</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="do">## must have the same names between concentration and dose objects.)</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>dose_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAdose</span>(d_dose_both,</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>                     Dose<span class="sc">~</span>Time<span class="sc">|</span>Study<span class="sc">+</span>Subject)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co"># Perform and summarize the PK data as previously described</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>data_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAdata</span>(conc_obj, dose_obj)</span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>results_obj <span class="ot">&lt;-</span> <span class="fu">pk.nca</span>(data_obj)</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="fu">summary</span>(results_obj)</span></code></pre></div>
</div>
<div id="selecting-calculation-intervals" class="section level1">
<h1>Selecting Calculation Intervals</h1>
<p>All NCA calculations require the interval over which they are
calculated. When the concentration and dosing information are combined
to the PKNCAdata object, intervals are automatically determined. The
exception to this automatic determination is if the user provides
intervals.</p>
<p>When selected either automatically or manually, intervals define at
minimum a start time, an end time, and the parameters to be calculated.
The parameter list is available from the <code>get.interval.cols</code>
function. The parameters requested are specified by setting the entry in
a data.frame as requested.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>intervals <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="at">start=</span><span class="dv">0</span>, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">24</span>, <span class="cn">Inf</span>),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">cmax=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="at">tmax=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="at">auclast=</span><span class="cn">TRUE</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="at">aucinf.obs=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  )</span></code></pre></div>
<p>Intervals like the one above are sufficient for designs with a single
type of treatment– such as single doses. For more complex treatments in
a single analysis, like the combination of single and multiple doses,
include a treatment column matching the treatment column name from the
concentration data set. See the <a href="#manual-interval-specification">Manual Interval Specification</a>
section below for more details.</p>
<div id="selection-of-data-used-for-calculation" class="section level2">
<h2>Selection of Data Used for Calculation</h2>
<p>When choosing which data is used for a calculation, PKNCA will never
look beyond the data specified in the group and interval. Groups are
defined by the call to the <code>PKNCAconc</code> function, and they
will typically define the measurement of a single analyte from a single
individual receiving a single treatment. Intervals are subsets within a
group by start and end time. PKNCA never examines data outside of the
group and interval for standard NCA calculations. As an example, with
data from 0 to 48 hours and an interval set to <code>start</code> at 0
and <code>end</code> at 24 with the calculation of
<code>aucinf.obs</code>, any data after 24 hours will not be used for
the half-life or AUC<sub>inf</sub> calculations.</p>
<p>A few functions look at data outside of a single interval, but these
functions do not look at data outside of a single group, and these
functions are typically used during preparation for NCA calculations not
for the calculations themselves. Functions that look at a group as a
whole include <code>choose.auc.intervals</code>, <code>find.tau</code>,
and <code>pk.tss</code>.</p>
</div>
<div id="automatic-interval-determination" class="section level2">
<h2>Automatic Interval Determination</h2>
<p>If intervals are not specified when combining the concentration and
dosing data, they will automatically be found from the concentration and
dosing data.</p>
<p>Single dose data has a simple interval selection: the option
<code>single.dose.aucs</code> is used from the
<code>PKNCA.options</code>.</p>
<table style="width:100%;">
<colgroup>
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="1%" />
<col width="1%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">start</th>
<th align="right">end</th>
<th align="left">auclast</th>
<th align="left">aucall</th>
<th align="left">aumclast</th>
<th align="left">aumcall</th>
<th align="left">aucint.last</th>
<th align="left">aucint.last.dose</th>
<th align="left">aucint.all</th>
<th align="left">aucint.all.dose</th>
<th align="left">c0</th>
<th align="left">cmax</th>
<th align="left">cmin</th>
<th align="left">tmax</th>
<th align="left">tlast</th>
<th align="left">tfirst</th>
<th align="left">clast.obs</th>
<th align="left">cl.last</th>
<th align="left">cl.all</th>
<th align="left">f</th>
<th align="left">mrt.last</th>
<th align="left">mrt.iv.last</th>
<th align="left">vss.last</th>
<th align="left">vss.iv.last</th>
<th align="left">cav</th>
<th align="left">cav.int.last</th>
<th align="left">cav.int.all</th>
<th align="left">ctrough</th>
<th align="left">cstart</th>
<th align="left">ptr</th>
<th align="left">tlag</th>
<th align="left">deg.fluc</th>
<th align="left">swing</th>
<th align="left">ceoi</th>
<th align="left">aucabove.predose.all</th>
<th align="left">aucabove.trough.all</th>
<th align="left">count_conc</th>
<th align="left">count_conc_measured</th>
<th align="left">totdose</th>
<th align="left">ae</th>
<th align="left">clr.last</th>
<th align="left">clr.obs</th>
<th align="left">clr.pred</th>
<th align="left">fe</th>
<th align="left">sparse_auclast</th>
<th align="left">sparse_auc_se</th>
<th align="left">sparse_auc_df</th>
<th align="left">time_above</th>
<th align="left">aucivlast</th>
<th align="left">aucivall</th>
<th align="left">aucivint.last</th>
<th align="left">aucivint.all</th>
<th align="left">aucivpbextlast</th>
<th align="left">aucivpbextall</th>
<th align="left">aucivpbextint.last</th>
<th align="left">aucivpbextint.all</th>
<th align="left">half.life</th>
<th align="left">r.squared</th>
<th align="left">adj.r.squared</th>
<th align="left">lambda.z</th>
<th align="left">lambda.z.time.first</th>
<th align="left">lambda.z.time.last</th>
<th align="left">lambda.z.n.points</th>
<th align="left">clast.pred</th>
<th align="left">span.ratio</th>
<th align="left">thalf.eff.last</th>
<th align="left">thalf.eff.iv.last</th>
<th align="left">kel.last</th>
<th align="left">kel.iv.last</th>
<th align="left">aucinf.obs</th>
<th align="left">aucinf.pred</th>
<th align="left">aumcinf.obs</th>
<th align="left">aumcinf.pred</th>
<th align="left">aucint.inf.obs</th>
<th align="left">aucint.inf.obs.dose</th>
<th align="left">aucint.inf.pred</th>
<th align="left">aucint.inf.pred.dose</th>
<th align="left">aucivinf.obs</th>
<th align="left">aucivinf.pred</th>
<th align="left">aucivpbextinf.obs</th>
<th align="left">aucivpbextinf.pred</th>
<th align="left">aucpext.obs</th>
<th align="left">aucpext.pred</th>
<th align="left">cl.obs</th>
<th align="left">cl.pred</th>
<th align="left">mrt.obs</th>
<th align="left">mrt.pred</th>
<th align="left">mrt.iv.obs</th>
<th align="left">mrt.iv.pred</th>
<th align="left">mrt.md.obs</th>
<th align="left">mrt.md.pred</th>
<th align="left">vz.obs</th>
<th align="left">vz.pred</th>
<th align="left">vss.obs</th>
<th align="left">vss.pred</th>
<th align="left">vss.iv.obs</th>
<th align="left">vss.iv.pred</th>
<th align="left">vss.md.obs</th>
<th align="left">vss.md.pred</th>
<th align="left">cav.int.inf.obs</th>
<th align="left">cav.int.inf.pred</th>
<th align="left">thalf.eff.obs</th>
<th align="left">thalf.eff.pred</th>
<th align="left">thalf.eff.iv.obs</th>
<th align="left">thalf.eff.iv.pred</th>
<th align="left">kel.obs</th>
<th align="left">kel.pred</th>
<th align="left">kel.iv.obs</th>
<th align="left">kel.iv.pred</th>
<th align="left">auclast.dn</th>
<th align="left">aucall.dn</th>
<th align="left">aucinf.obs.dn</th>
<th align="left">aucinf.pred.dn</th>
<th align="left">aumclast.dn</th>
<th align="left">aumcall.dn</th>
<th align="left">aumcinf.obs.dn</th>
<th align="left">aumcinf.pred.dn</th>
<th align="left">cmax.dn</th>
<th align="left">cmin.dn</th>
<th align="left">clast.obs.dn</th>
<th align="left">clast.pred.dn</th>
<th align="left">cav.dn</th>
<th align="left">ctrough.dn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">24</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">Inf</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>For multiple-dose studies, PKNCA selects one group at a time and
compares the concentration and dosing times. When there is a
concentration measurement between doses, an interval row is added. The
dosing interval (<span class="math inline">\(\tau\)</span>) is
determined by looking for pattern repeats within the dosing data using
the <code>find.tau</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="do">## find.tau can work when all doses have the same interval...</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>dose_times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">168</span>, <span class="at">by=</span><span class="dv">24</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">print</span>(dose_times)</span></code></pre></div>
<pre><code>## [1]   0  24  48  72  96 120 144 168</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>PKNCA<span class="sc">::</span><span class="fu">find.tau</span>(dose_times)</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## or when the doses have mixed intervals (10 and 24 hours).</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>dose_times <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">168</span>, <span class="at">by=</span><span class="dv">24</span>),</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                     <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">178</span>, <span class="at">by=</span><span class="dv">24</span>)))</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">print</span>(dose_times)</span></code></pre></div>
<pre><code>##  [1]   0  10  24  34  48  58  72  82  96 106 120 130 144 154 168 178</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>PKNCA<span class="sc">::</span><span class="fu">find.tau</span>(dose_times)</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<p>After finding <span class="math inline">\(\tau\)</span>, PKNCA will
also look after the last dose (or the beginning of the last dosing
interval), and two additional intervals may be added:</p>
<ul>
<li>one interval for the dosing interval after the beginning of the last
dosing interval (if there are concentrations measured in the
interval)</li>
<li>one interval for the half-life after the last dosing interval (if
there are concentration more than <span class="math inline">\(\tau\)</span> after the beginning of the last
interval).</li>
</ul>
<p>One consequence of automatic interval selection is that many rows are
generated for intervals; one row is generated per interval per subject.
The benefit of the method producing a large number of rows is that it is
fully flexible to the actual study results. If a subject has a different
schedule than the others for the same treatment (e.g. measurements that
were nominally scheduled for day 14 occurred on day 13), those
differences will be found.</p>
</div>
<div id="manual-interval-specification" class="section level2">
<h2>Manual Interval Specification</h2>
<p>Intervals can also be specified manually. Two use cases are common
for manual specification: fully manual (never requesting the automatic
intervals) and updating the automatic intervals.</p>
<p>Fully manual intervals can be specified by providing it to the
<code>PKNCAdata</code> call.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>intervals_manual <span class="ot">&lt;-</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>    <span class="at">start=</span><span class="dv">0</span>, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">24</span>, <span class="cn">Inf</span>),</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>    <span class="at">cmax=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="at">tmax=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>    <span class="at">auclast=</span><span class="cn">TRUE</span>,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>    <span class="at">aucinf.obs=</span><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>data_obj <span class="ot">&lt;-</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="fu">PKNCAdata</span>(</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>    conc_obj, dose_obj, </span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>    <span class="at">intervals=</span>intervals_manual</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  )</span></code></pre></div>
<p>To update the automatically-selected intervals, extract the
intervals, modify them, and put them back.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>data_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAdata</span>(conc_obj, dose_obj)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>intervals_manual <span class="ot">&lt;-</span> data_obj<span class="sc">$</span>intervals</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>intervals_manual<span class="sc">$</span>aucinf.obs[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>data_obj<span class="sc">$</span>intervals <span class="ot">&lt;-</span> intervals_manual</span></code></pre></div>
</div>
<div id="keeping-a-column-from-intervals" class="section level2">
<h2>Keeping a column from intervals</h2>
<p>When computing NCA using actual times, grouping by start and end time
in summaries (see layer) is less helpful because everyone could have
different start and end times. So, you may keep the interval columns
using the option <code>&quot;keep_interval_cols&quot;</code> as follows (where
“dosetype” must be a column name in the intervals):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>data_obj <span class="ot">&lt;-</span> <span class="fu">PKNCAdata</span>(conc_obj, dose_obj, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">keep_interval_cols =</span> <span class="st">&quot;dosetype&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="summarizing-results" class="section level1">
<h1>Summarizing results</h1>
<p>When NCA has been calculated, you can summarize the results with the
<code>summary()</code> function.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">summary</span>(o_nca)</span></code></pre></div>
<p>By default, it will count the number of unique subjects
(<code>N</code>) in the summary, and when the number of subjects differs
from the number of measurements included in a summary (<code>n</code>),
it will summarize <code>n</code> for the given parameters. Note that
counting of “n” includes all non-missing values that were not excluded
from summarization; this will included all zeros that are e.g. excluded
from geometric statistics.</p>
<p>Edge cases like two unique subjects where one has an excluded value
and one has duplicated values (<code>N = 2</code> and <code>n = 2</code>
even though both measurements come from a single subject) are to be
handled by the user.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
